<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Results | VoteVibes</title>
  <link rel="stylesheet" href="dashboard.css" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
</head>

<body>

  <!-- Navbar -->
  <header class="navbar">
    <div class="logo"><i class="fa-solid fa-dove"></i> VoteVibes</div>
    <ul class="nav-links">
      <li><a href="voter-dashboard.html">Dashboard</a></li>
      <li><a href="active.html">Active Elections</a></li>
      <li><a href="result.html" class="active">Results</a></li>
      <li><a href="upcoming.html">Upcoming</a></li>
    </ul>

    <div class="nav-actions">
      <div class="profile-menu">
        <i class="fa-solid fa-circle-user profile-icon"></i>
        <div class="dropdown hidden">
          <a href="profile.html"><i class="fa-solid fa-user"></i> Profile</a>
          <a onclick="logoutUser()"><i class="fa-solid fa-right-from-bracket"></i> Logout</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Header Section -->
  <section class="welcome">
    <h2>üèÜ Election Results</h2>
    <p>View the outcomes of completed elections.</p>
  </section>

  <!-- Results Section -->
  <main class="features" id="resultsContainer">
    <!-- JS will insert result cards here -->
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-content">
      <div>
        <h4>About VoteVibes</h4>
        <p>Secure, transparent and student-friendly voting system.</p>
      </div>
      <div>
        <h4>Quick Links</h4>
        <ul>
          <li><a href="voter-dashboard.html">Dashboard</a></li>
          <li><a href="active.html">Active Elections</a></li>
          <li><a href="upcoming.html">Upcoming</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">&copy; 2025 VoteVibes. All Rights Reserved.</div>
  </footer>

  <script>
    // ==== Navbar Dropdown ====
    const profileIcon = document.querySelector(".profile-icon");
    const dropdown = document.querySelector(".dropdown");
    profileIcon.addEventListener("click", (e) => {
      dropdown.classList.toggle("hidden");
      e.stopPropagation();
    });
    document.addEventListener("click", (e) => {
      if (!dropdown.contains(e.target)) dropdown.classList.add("hidden");
    });

    // ==== Mock Election Results (ISO Dates for backend) ====
    const elections = [
      {
        name: "Student Council Election 2025",
        startDate: "2025-10-01",
        endDate: "2025-11-04",
        candidates: [
          { name: "Riya Sharma", votes: 58 },
          { name: "Aarav Patel", votes: 42 },
          { name: "Sneha Verma", votes: 37 },
        ],
        completed: true,
      },
      {
        name: "Sports Captain Election 2026",
        startDate: "2026-01-05",
        endDate: "2026-01-18",
        candidates: [
          { name: "Ishaan Mehta", votes: 0 },
          { name: "Priya Nair", votes: 0 },
        ],
        completed: false,
      }
    ];

    const container = document.getElementById("resultsContainer");

    // Show only completed elections
    const completedElections = elections.filter(e => e.completed);

    if (completedElections.length === 0) {
      container.innerHTML = `
        <p style="text-align:center; color:#001a66; font-weight:500; font-size:1.1rem; margin-top:30px;">
          No completed elections yet üïí
        </p>`;
    } else {
      completedElections.forEach(election => {
        const card = document.createElement("div");
        card.className = "card";

        // üßÆ Format dates for display (DD-MM-YYYY)
        const formattedStart = new Date(election.startDate).toLocaleDateString('en-GB');
        const formattedEnd = new Date(election.endDate).toLocaleDateString('en-GB');

        // üèÜ Find winner
        const winner = election.candidates.reduce((max, c) => (c.votes > max.votes ? c : max));

        // üó≥Ô∏è Build candidate list
        let candidateList = "<ul>";
        election.candidates.forEach(c => {
          candidateList += `<li>${c.name}: <strong>${c.votes}</strong> votes ${
            c.name === winner.name ? "ü•á" : ""
          }</li>`;
        });
        candidateList += "</ul>";

        card.innerHTML = `
          <h3>${election.name}</h3>
          <p><strong>Start Date:</strong> ${formattedStart}</p>
          <p><strong>End Date:</strong> ${formattedEnd}</p>
          <p><strong>Status:</strong> Completed</p>
          <p><strong>Winner:</strong> ${winner.name} üèÜ (${winner.votes} votes)</p>
          ${candidateList}
        `;
        container.appendChild(card);
      });
    }

    // ==== Logout ====
    function logoutUser() {
      localStorage.removeItem("user");
      window.location.href = "login.html";
    }
  </script>

  <style>
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 5px 0;
      color: #333;
    }
    li strong {
      color: #001a66;
    }
  </style>
</body>
</html>
